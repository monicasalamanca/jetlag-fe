"use client";

import { useState, useEffect } from "react";
import { fetchGuidesClient } from "@/api/client";
import { Guide } from "@/api/types";

import s from "./specific-guide-lander.module.scss";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import {
  faBook,
  faCheck,
  faDollarSign,
  faDownload,
  faFilePdf,
  faMapLocation,
  faPassport,
  faShieldHalved,
  faStar,
  faTrain,
  faWifi,
  faXmark,
} from "@fortawesome/free-solid-svg-icons";
import Image from "next/image";

const SpecificGuidesLander = () => {
  const images = [
    {
      src: "https://res.cloudinary.com/jetlagchronicles/image/upload/v1769460458/eguides/Screenshot_2026-01-26_at_3.34.00_PM_wbx60j.png",
      alt: "Our guide sample page showing the content",
    },
    {
      src: "https://res.cloudinary.com/jetlagchronicles/image/upload/v1769460459/eguides/Screenshot_2026-01-26_at_3.36.12_PM_zij4y0.png",
      alt: "Our guide sample page showing the content",
    },
    {
      src: "https://res.cloudinary.com/jetlagchronicles/image/upload/v1769460459/eguides/Screenshot_2026-01-26_at_3.39.40_PM_iqrp0b.png",
      alt: "Our guide sample page showing the content",
    },
    {
      src: "https://res.cloudinary.com/jetlagchronicles/image/upload/v1769460458/eguides/Screenshot_2026-01-26_at_3.43.11_PM_vbyycy.png",
      alt: "Our guide sample page showing the content",
    },
  ];

  // FAQ data
  const faqItems = [
    {
      question: "Is this guide suitable for first-time visitors to Thailand?",
      answer:
        "This guide is designed for those planning to live or stay long-term on Thailand's islands. It covers practical details for expats, digital nomads, and long-term travelers, but may be too in-depth for short-term tourists.",
    },
    {
      question: "Do I need any special software to view the guide?",
      answer:
        "No special software is required. The guide is delivered as a PDF, which can be opened on any device with a standard PDF reader.",
    },
    {
      question: "Is the information up to date for 2026?",
      answer:
        "Yes, all content has been updated for 2026, including cost breakdowns, visa requirements, and local realities.",
    },
    {
      question: "Can I access the guide instantly after purchase?",
      answer:
        "Yes, you will receive instant access to download the guide after completing your purchase.",
    },
    {
      question: "Is there a refund policy if the guide isn't what I expected?",
      answer:
        "We offer a satisfaction guarantee. If the guide does not meet your expectations, contact us within 14 days for a full refund.",
    },
  ];

  const [guides, setGuides] = useState<Guide[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [openIndex, setOpenIndex] = useState<number | null>(null);

  // Keyboard accessibility: handle Enter/Space
  const handleKeyDown = (
    e: React.KeyboardEvent<HTMLButtonElement>,
    idx: number
  ) => {
    if (e.key === "Enter" || e.key === " ") {
      e.preventDefault();
      setOpenIndex(openIndex === idx ? null : idx);
    }
  };

  //   useEffect(() => {
  //     const loadGuides = async () => {
  //       try {
  //         setLoading(true);
  //         setError(null);
  //         const fetchedGuides = await fetchGuidesClient();

  //         if (fetchedGuides) {
  //           setGuides(fetchedGuides);
  //         } else {
  //           setGuides([]);
  //           setError("No guides available at the moment.");
  //         }
  //       } catch (err) {
  //         console.error("Error loading guides:", err);
  //         setError("Failed to load guides. Please try again later.");
  //         setGuides([]);
  //       } finally {
  //         setLoading(false);
  //       }
  //     };

  //     loadGuides();
  //   }, []);

  return (
    <main className={s.container}>
      <section className={s.guidePresentation}>
        <div className={s.wrapper}>
          <div className={s.guideMainInfo}>
            <div className={s.updated}>
              <FontAwesomeIcon className={s.icon} icon={faStar} />
              Updated for 2026
            </div>
            <h2>Which Thai Island Makes Sense In 2026?</h2>
            <p>
              What it really costs to live on Thailand’s islands. Rent, food,
              transport, visas, and the hidden expenses that drain newcomers
              fast.
            </p>
            <div className={s.guideInfoBits}>
              <div className={s.infoBitWrapper}>
                <div className={s.iconWrapper}>
                  <FontAwesomeIcon className={s.icon} icon={faFilePdf} />
                </div>
                <div>
                  <div className={s.label}>Format</div>
                  <div className={s.value}>PDF</div>
                </div>
              </div>
              <div className={s.infoBitWrapper}>
                <div className={s.iconWrapper}>
                  <FontAwesomeIcon className={s.icon} icon={faBook} />
                </div>
                <div>
                  <div className={s.label}>Pages</div>
                  <div className={s.value}>87 Pages</div>
                </div>
              </div>
              <div className={s.infoBitWrapper}>
                <div className={s.iconWrapper}>
                  <FontAwesomeIcon className={s.icon} icon={faDownload} />
                </div>
                <div>
                  <div className={s.label}>Access</div>
                  <div className={s.value}>Instant</div>
                </div>
              </div>
            </div>
            <div className={s.ctaWrapper}>
              <button className={s.ctaButton}>Flip through real pages</button>
              <button className={s.ctaButtonOptions}>
                View Bundle Options
              </button>
            </div>
          </div>
          <div className={s.guideCoverImage}>
            <Image
              className={s.image}
              src="https://res.cloudinary.com/jetlagchronicles/image/upload/v1769021373/small_pexels_itsehsanh_30944533_0fc7d7d8f5.jpg"
              alt="Guide Cover"
              fill
              sizes="(max-width: 768px) 100vw, 50vw"
              loading="lazy"
            />
            <div className={s.imageGuideTag}>
              <FontAwesomeIcon className={s.icon} icon={faCheck} />
              <div>
                <p>One-Time purchase</p>
                <p>Lifetime access included</p>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section className={s.isThisGuideForYou}>
        <div className={s.wrapper}>
          <h2>Is This Guide For You?</h2>
          <div className={s.points}>
            <div className={s.perfectForPoints}>
              <div className={s.title}>
                <FontAwesomeIcon className={s.icon} icon={faCheck} />
                <h3>Perfect For</h3>
              </div>
              <div className={s.pointsList}>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faCheck} />
                  <p>Individuals planning to move to Thailand</p>
                </div>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faCheck} />
                  <p>Expats seeking in-depth island living info</p>
                </div>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faCheck} />
                  <p>Long-term travelers wanting local insights</p>
                </div>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faCheck} />
                  <p>Digital nomads exploring Thailand's islands</p>
                </div>
              </div>
            </div>
            <div className={s.notForPoints}>
              <div className={s.title}>
                <FontAwesomeIcon
                  className={s.icon + " " + s.notForIcon}
                  icon={faXmark}
                />
                <h3>Not For</h3>
              </div>
              <div className={s.pointsList}>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faXmark} />
                  <p>Budget travelers on a tight budget</p>
                </div>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faXmark} />
                  <p>Short-term tourists visiting for a week</p>
                </div>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faXmark} />
                  <p>Travelers seeking only luxury options</p>
                </div>
                <div>
                  <FontAwesomeIcon className={s.icon} icon={faXmark} />
                  <p>Individuals uninterested in Thailand</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section className={s.whatsInside}>
        <div className={s.wrapper}>
          <h2>What's Inside</h2>
          <p>Concrete, Actionable Information</p>
          <div className={s.contentsGrid}>
            <div className={s.card}>
              <div className={s.imageWrapper}>
                <FontAwesomeIcon
                  icon={faDollarSign}
                  className={`${s.icon} ${s.blue}`}
                />
              </div>
              <div className={s.contentWrapper}>
                <h3>Cost of Living Breakdowns</h3>
                <p className={s.desc}>
                  Real numbers for rent, food, transport, utilities and
                  entertainment. Monthly budgets for different lifestyles.
                </p>
              </div>
            </div>
            <div className={s.card}>
              <div className={s.imageWrapper}>
                <FontAwesomeIcon
                  icon={faMapLocation}
                  className={`${s.icon} ${s.blue}`}
                />
              </div>
              <div className={s.contentWrapper}>
                <h3>Best Neighborhoods</h3>
                <p className={s.desc}>
                  Honest pros and cons of every major area. Where to live based
                  on your prioritoes and budget.
                </p>
              </div>
            </div>
            <div className={s.card}>
              <div className={s.imageWrapper}>
                <FontAwesomeIcon
                  icon={faShieldHalved}
                  className={`${s.icon} ${s.blue}`}
                />
              </div>
              <div className={s.contentWrapper}>
                <h3>Common Scams and Mistakes</h3>
                <p className={s.desc}>
                  What to watch out for, how to avoid getting ripped off, and
                  lessons learned the hard way.
                </p>
              </div>
            </div>
            <div className={s.card}>
              <div className={s.imageWrapper}>
                <FontAwesomeIcon
                  icon={faTrain}
                  className={`${s.icon} ${s.blue}`}
                />
              </div>
              <div className={s.contentWrapper}>
                <h3>Transportation Realities</h3>
                <p className={s.desc}>
                  How to actually get around. BTS, MRT, taxis, Grab, motorbikes.
                  What works and what doesn't.
                </p>
              </div>
            </div>
            <div className={s.card}>
              <div className={s.imageWrapper}>
                <FontAwesomeIcon
                  icon={faPassport}
                  className={`${s.icon} ${s.blue}`}
                />
              </div>
              <div className={s.contentWrapper}>
                <h3>Visa and Stay Logistics</h3>
                <p className={s.desc}>
                  Visa options, extensions, and how to stay legal without
                  headaches.
                </p>
              </div>
            </div>
            <div className={s.card}>
              <div className={s.imageWrapper}>
                <FontAwesomeIcon
                  icon={faWifi}
                  className={`${s.icon} ${s.blue}`}
                />
              </div>
              <div className={s.contentWrapper}>
                <h3>Lifestyle and Realities</h3>
                <p className={s.desc}>
                  Internet speeds, noise levels, cultural quirks,
                  bureaucracy,and what daily life really feels like.
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section className={s.previewSamplePages}>
        <div className={s.wrapper}>
          <h2>Preview Samples</h2>
          <p>See what you're getting before you buy</p>
          <div className={s.content}>
            <div className={s.imageScroll}>
              {images.map((image, index) => (
                <div key={index} className={s.imageWrapper}>
                  <Image
                    className={s.image}
                    src={image.src}
                    alt={image.alt}
                    width={320}
                    height={320}
                    priority={index < 2}
                  />
                </div>
              ))}
            </div>
          </div>
        </div>
      </section>
      <section className={s.saleSection}>
        <div className={s.wrapper}>
          {/* <h2>Preview Samples</h2>
          <p>See what you're getting before you buy</p> */}
        </div>
      </section>
      <section className={s.faq}>
        <div className={s.wrapper}>
          <h2>Frequently Asked Questions</h2>
          <p>Everything you need to know before purchasing</p>
        </div>
      </section>
        // FAQ data
        const faqItems = [
          {
            question: "Is this guide suitable for first-time visitors to Thailand?",
            answer:
              "This guide is designed for those planning to live or stay long-term on Thailand’s islands. It covers practical details for expats, digital nomads, and long-term travelers, but may be too in-depth for short-term tourists.",
          },
          {
            question: "Do I need any special software to view the guide?",
            answer:
              "No special software is required. The guide is delivered as a PDF, which can be opened on any device with a standard PDF reader.",
          },
          {
            question: "Is the information up to date for 2026?",
            answer:
              "Yes, all content has been updated for 2026, including cost breakdowns, visa requirements, and local realities.",
          },
          {
            question: "Can I access the guide instantly after purchase?",
            answer:
              "Yes, you will receive instant access to download the guide after completing your purchase.",
          },
          {
            question: "Is there a refund policy if the guide isn’t what I expected?",
            answer:
              "We offer a satisfaction guarantee. If the guide does not meet your expectations, contact us within 14 days for a full refund.",
          },
        ];

        // Accordion state: only one open at a time
        const [openIndex, setOpenIndex] = useState<number | null>(null);

        // Keyboard accessibility: handle Enter/Space
        const handleKeyDown = (e: React.KeyboardEvent<HTMLButtonElement>, idx: number) => {
          if (e.key === "Enter" || e.key === " ") {
            setOpenIndex(openIndex === idx ? null : idx);
          }
        };

        return (
          <main className={s.container}>
            {/* ...existing code... */}
            <section className={s.faq}>
              <div className={s.wrapper}>
                {/* FAQ Accordion Section */}
                <div className={s.faqAccordionContainer}>
                  {faqItems.map((item, idx) => (
                    <div key={idx} className={s.faqItem}>
                      <button
                        className={s.faqQuestion}
                        aria-expanded={openIndex === idx}
                        aria-controls={`faq-answer-${idx}`}
                        id={`faq-question-${idx}`}
                        onClick={() => setOpenIndex(openIndex === idx ? null : idx)}
                        onKeyDown={(e) => handleKeyDown(e, idx)}
                        tabIndex={0}
                      >
                        <span>{item.question}</span>
                        <span
                          className={
                            openIndex === idx
                              ? `${s.chevron} ${s.chevronOpen}`
                              : s.chevron
                          }
                          aria-hidden="true"
                        >
                          {/* Chevron SVG */}
                          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                              d="M6 8L10 12L14 8"
                              stroke="currentColor"
                              strokeWidth="2"
                              strokeLinecap="round"
                              strokeLinejoin="round"
                            />
                          </svg>
                        </span>
                      </button>
                      <div
                        id={`faq-answer-${idx}`}
                        role="region"
                        aria-labelledby={`faq-question-${idx}`}
                        className={
                          openIndex === idx
                            ? `${s.faqAnswer} ${s.faqAnswerOpen}`
                            : s.faqAnswer
                        }
                        style={{ maxHeight: openIndex === idx ? "500px" : "0px" }}
                      >
                        <p>{item.answer}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </section>
          </main>
        );
    </main>
  );
};

export default SpecificGuidesLander;
